#
# Autogenerated Makefile
# Created by scripts/configure.php
# Nate Bosscher
#
SHELL = /bin/sh
CXX = gcc

FLAGS =

XENO_CONFIG := /usr/xenomai/bin/xeno-config
XENO_CFLAGS=$(shell $(XENO_CONFIG) --skin=alchemy --cflags)
XENO_LD=$(shell $(XENO_CONFIG) --skin=alchemy --ldflags)

MAGICK_CONFIG := /usr/bin/Magick++-config
MAGICK_CPP=$(shell $(MAGICK_CONFIG) --cppflags)
MAGICK_LD=$(shell $(MAGICK_CONFIG) --ldflags --libs)

ALSA_LD=-lasound

STD_CFLAGS=-I/usr/include/c++/4.9.2 -std=c++11
CPPFLAGS       = $(FLAGS) $(XENO_CFLAGS) $(D_LIB_CFLAGS) $(STD_CFLAGS) -Wall $(MAGICK_CPP)
DEBUG_FLAGS = -g

SOURCES = $(shell find ./src -name '*.cpp') -L/usr/lib -ljpeg
T_SOURCES = $(shell find ./src -name '*.cpp' | grep -v 'Main.cpp') $(shell find ./test -name '*.cpp')

HEADERS = $(shell find ./src -name '*.h')

OBJECTS = $(SOURCES:.cpp=.o)
T_OBJECTS = $(T_SOURCES:.cpp=.o)

LDFLAGS= -L$(shell $(XENO_CONFIG) --skin=alchemy --library-dir) -Wall -lstdc++ -ljpeg -lpthread -ldl -lm $(XENO_LD) $(MAGICK_LD) $(ALSA_LD)

PRECOMPILE = $(shell )
#POSTCOMPILE = mv -f $(DEPDIR)/$*.Td $(DEPDIR)/$*.d

EXEC = a.out
T_EXEC = test.out
D_EXEC = debug.out

$(info )
$(info *************************************************)
$(info Performing build...)
$(info *************************************************)
$(info )

# Perform pre-compile commands
$(info )
$(info *************************************************)
$(info Performing pre-compile commands...)

$(shell find . -name "*.o" -type f -delete)
$(shell rm *.out)

$(info *************************************************)
$(info )


all: $(EXEC)	

test: $(T_EXEC)

debug: $(D_EXEC)
	
$(EXEC) : $(OBJECTS)
	$(CXX) $(OBJECTS) -o $(EXEC) $(LDFLAGS)

$(T_EXEC) : $(T_OBJECTS)
	$(CXX) $(T_OBJECTS) -o $(T_EXEC) \
	$(LDFLAGS)

$(D_EXEC) : $(T_OBJECTS)
	$(CXX) $(DEBUG_FLAGS) $(T_OBJECTS) -o $(D_EXEC) \
	$(LDFLAGS)

%.o : %.cpp
	$(CXX) $(DEBUG_FLAGS) -c $(CPPFLAGS) $< -o $@

clean:
	rm -f $(EXEC) $(OBJECTS)
	rm -f $(EXEC) $(T_OBJECTS)
